use std::ops::Index;

#[derive(PartialEq)]
enum MapElement {
    Space,
    Tree,
}

impl MapElement {
    fn rank(&self) -> i64 {
        match self {
            Self::Space => 0,
            Self::Tree => 1
        }
    }
}

struct Map {
    el: Vec<Vec<MapElement>>
}

impl From<&str> for Map {
    fn from(s: &str) -> Self {
        let d: Vec<Vec<MapElement>> = s.lines()
            .map(|l| {
                l.chars()
                    .map(|ch| {
                        match ch {
                            '.' => MapElement::Space,
                            '#' => MapElement::Tree,
                            _ => { panic!("unexpected value") }
                        }
                    })
                    .collect()
            })
            .collect();
        Self { el: d }
    }
}

impl Map {
    fn get_height(&self) -> usize { self.el.len() }
    fn get_width(&self) -> usize { self.el[0].len() }
}

impl Index<(usize, usize)> for Map {
    type Output = MapElement;

    fn index(&self, index: (usize, usize)) -> &Self::Output {
        &self.el[index.0][index.1 % self.get_width()]
    }
}

fn find_tree_count(dx: usize, dy: usize) -> i64 {
    let map = Map::from(DATA);
    let mut pos = (0, 0);
    let mut tree_count = 0i64;
    while pos.0 < map.get_height() {
        tree_count += map[pos].rank();
        pos = (pos.0 + dy, pos.1 + dx);
    };

    tree_count
}

fn main() {
    let mut res = find_tree_count(1, 1);
    res *= find_tree_count(3, 1);
    res *= find_tree_count(5, 1);
    res *= find_tree_count(7, 1);
    res *= find_tree_count(1, 2);
    println!("{}", res);
}


static DATA: &str = r#"....#...............#.#..###.##
.#..#....###..............##...
....###......#....#.#...#.##..#
.......#........#..###...##....
.....#..#......#..#..##..#...#.
....#..........#....#...#......
............###...#............
##......#.....#......#.....##..
........#.........##..#.#...##.
....#.#..#.#...#........#..#...
.#.....#.#......#....#..#..#..#
#.##..##......#.....##...#..#..
#........#..##...###....##.....
......#.#..##...#.#.....#......
##.......#..#.........#...#....
.....##.........#....#.#.###.#.
..##...........#.#.#.#.....#.#.
....#...............#......#.#.
#.#..#....#.....#.....##...#..#
#......#..............#.#.##...
......###.....#...#........###.
####...#.....#...#....#........
.......#...#....##...#.........
.####..##............#.........
#.#...#...#....#...#.#......#..
..#..#.....#.......#...#.#...##
.#.........#...#......##.#...#.
.#.#...#...#.....#.#........#.#
.#.....###....###..##.#..##.#..
.....##....#......#..#...#...#.
#...##....#.......#.....##.##..
#...#.....#.#...........#..###.
##.#........###...........###.#
#...#.#........#.#.....#.......
..................#..#.........
.....#.#..#.#......#..#.....##.
.#.#.......#..##........#..##.#
.#.#..#.#...#.......#.#.#..#...
...#......#....#....##.#..#....
......#.......##....##..#.....#
...#.##...##...............#..#
.###....#.#.....##..#.......#.#
#....#..........#...........#.#
...#...............#.#..#....#.
.....#..##..........#..###.....
.....####.....#.#.......#...#..
#.............#...#.......##...
.#....##.......#.#......#.#.##.
.#..#.......#..##...#...#......
#.......#..#..#..#.....#.......
##...#.#.#...........#....#....
.......#..#.#..............#.#.
.....#.......#.......#.#.#.....
....##.##.....#......#.......#.
#...#..#.#....###....##...#.#.#
#..#......#........#.#.#.....#.
###..##..#......#.....#.......#
..##....#.#.#......#..##...#...
.....#..#....#...#.#...#...#...
.....#.#..###.#..#...##......#.
#.#..#....#..#.....#.#...#.#...
.#..#....#.......#..#.......#..
#.........#..#..#.........##..#
..##.##..#..#...##.............
.....###...#..#...##.#..#......
#.##.....##..............#.....
.......#.##.#.##...#.#.......##
...#.#.##...#......#...........
##.#........#.....##.....#.....
.#.....#.............#......#..
....#..##..#..#....#..#.#......
.#.....#....##..##..#...##.....
.##........#.#.#.#..........#.#
...#.#.#..#....#...#..###.##...
.#....#....#.#.#.#....#..#.....
#.#.......#..#..#...........#.#
.....#.....##..#....##.........
....#.##..............#........
.................#....#.......#
...................###...#...#.
...#.#..#..##..##....#.....#...
#...#..........................
.......#..#..#.#..#.....#......
..##.#..#......#...#.##..##..#.
.##.........#.#...........#....
...#...#..##.#......#..#..#....
.....#.#....#...#............#.
.##..#.....##....#...#.........
#......##...#...#............#.
.....#.##...#.#....##..........
.............#.......#.#.......
##....#.#........#....#..##....
....#...##.#....##..#.....#.#..
...##..#....##......#...#......
.####.#..#..#.#...#.#.#....#...
.#........#.##....#.#....#.....
.........#....##..#..#.........
....##...#....##.............#.
....#..##.#....#.#..#...##.....
.....##...#..#....#......#.#...
..........#.......#.##..#.##..#
.......#.........#...#.##......
....##.#.......#...............
....#.......#..##.......##.#.##
#.#..#.#....#.#.........###...#
.#.##.....##..##...........#.#.
...#....##........##...#...#...
.#.##....#.#...#.#..#..#...#...
#....#.##...#.#..#....#.....#..
#..#...#........#...........#..
...........#.......#......#..#.
....##...#......##.....#......#
.#.##.#.#.............#....##..
.#...#...##.#.#........#..##.#.
.#.#........#.#...#..#........#
.###.#.#...#..#..#.#....#..#...
..##..##....#.#............#...
#..........#........#..#.#.#...
.#...#..#..#.#.....#.....#....#
#.....#.#.#.....####.......#...
...#.#........#.#.###...#.....#
.....#.....##....#....#..##...#
..#....###.##.#..#..#....#...#.
.....#.....#...........#.#.###.
.....#......###...#.#...##.....
...........###..#...#....#.#..#
...#..###.....#....#.#...#.....
.......#...#..#..##....#.#.#...
...#..####.###........#.....#..
..#......###..#..#.##..........
....#....##..##..##.......###..
...#.......#..#.#....##........
.#.#.....#.#.#..........#..#..#
.##....##....##...........##.##
........#......#.##....##...#.#
..#.#.....#..#....#..........#.
...........#...............#...
.....####.....#.....###.#..#...
..........####..##.##.#....#...
...#.#.#......#....#..#.#......
.#.#......###.....#....#.......
..#..#..#.......#..#...#.....#.
...#............#......##...###
......#.............#..#..###..
.#.#......#..##.#..#..#.#...#.#
.#.....#.......#..#...........#
..#.###.#..#...#.##..#.##......
....#.#........#..#.#...#.#.##.
.#..##.#..#.#.#...##..#.#......
.......#..#..#..#.....#.#.#..#.
.##.###..##.....#.##..#........
...##..............#.#.##....#.
##....#...#...........#........
..#........#.#.##..#.#...#..#..
.......#.......##.#..#....#.#..
.......#....##..#.#.#..#....#..
..........#....#..#..#....#....
........#.....#.#.....##.......
........##.###.........#.#.#...
###......####...#.#........#...
......#........#......#.....#..
##..#.##..##.###..#........##..
.#..#...#............##.##..#..
...........#..#.#..............
.##.#.#....#...............#..#
.........##.................#..
#............##..##.........##.
##........#.........#..##.#...#
........#.....#..#.........#.##
....#......#.....##.##.........
.#.#.....#.#..#..##....#....#..
.###...#..##....##.....#.#..##.
.#....#.#.......#..#..#...###..
..#.#......#.#..#.....###.....#
#....#..#...#.....#.......#.##.
.#.......##.#.#...#......#.....
###....#.#......#....#.#...##..
...#....####.......##.....#..#.
.#.................#.......##.#
...#.###..........#..##......#.
.....##.#..............##..#...
#.....#..#..........#..#.......
..#...#.#.#.......##.#.....#...
#........#.#........#.#.....#..
#.....#...##....##..##........#
.#.##..#...#....#........#..#..
#..#.....#....#...##......#....
...#...#...#.#.#....##....#.#.#
......#...............#.....#..
.......#.#..#..##.#.....#......
...........##......#...#.......
....##..##.....#.#...#.........
......##..###.......#....#.##..
......#..#.##....#..###..#.....
.....#.........#........##.....
.....####..................#...
.#.#...##................#.....
.#..#...#...#.....#.##..#..#...
.#................#...###....#.
...#....#...........#...#....#.
.......#....##...............#.
.#.#.##..##.......#....#....###
......#.#....#...#..#..........
....#.##.#.#...##.#.#......#...
##....#...##.....#..#.###.#....
.......#......#.........#.#...#
.##.#...........##.........#.#.
##..##.....#...#..#.#...#....#.
#..##......###........#...#....
.....#.#.......#...#..##....##.
.....#.#..#.....#.......#..##..
...#..#..............#.#.......
.#.#...###......###............
.....#.....#...#.###...........
.......#..................#...#
#....#...#...#....#....#.#....#
....#..#............#.#........
#....#..........#.#.#..#..#....
.......#....#......#....#......
.##.#.#...#...#...##...........
.........###.#..#..............
...#........##....#....#....###
....##..#.......#.#...#.#..#.#.
.....##....#..##.........#.....
........##..#........#.........
...........#..#.##..##...#.....
.........#.#..####..#...#.##.##
##..#.#.....##.....#.........#.
..#...#...#....#.#....#.....#.#
.###.#....#.#......#....#......
.##.....#....#.......#.#..#.##.
#..#..##.....#....#...##.....#.
...#.........####.........##..#
..#.....#....###.#.#...#..#....
.........#....#..#.#.........#.
.....###.##..#...#.....#..#..#.
....#......#..#.#...#.....#....
.......#...#..#....#.......#.#.
.#....#............#....####...
#..##..##....#.....#...#.....#.
...#...##...#.#....#...........
.......#####.....#..###.#..#...
.....#.....#.#....#.........#..
.###.#..#...##.##.#.#..#..#....
.#..#.##..#......#..........##.
##....#....#.........###..#....
..#.............#.......#.#....
..#.....#..##...#...###..#.##..
##...##...#.#....#..#..........
...............#.....#.......#.
....#.#......##.#......#...#.#.
.........#.............#.#.....
...#.#.........................
..#..#....##..#...###.##.......
...##.#...##..#.#.##.#...#.##..
.##....#....#.......#.....##..#
.#...............#..#...#......
...##.....##.###....#.....#...#
...#.....#...####....##....#..#
..#.#.###..##.....#........#...
.....##.##..#..#.........##....
........##.....#..........#.##.
..##.#....####..#...........#..
##....#..#..#.#.##.....#...##..
...#...#......#..#.#....#......
##.....##.......##.##....#.....
.........#...##...........#....
.###.#..#....##...#.....#.....#
...#..........#.###..##...#.##.
...#..#....#.#.#.......###.....
....#..#.#.....##...#.#.#.#....
.......##..#...##..##.#....#...
.##..........#.#.#.....#.....#.
#....#......##...#..##.#..#..#.
.#...#.....###..#......#.....#.
.#..#.###.......#.##....###....
#....#....#....#....#..#.##....
..#..#.....#.....#....###.....#
##.###..#...##.......#.#.......
#...##......##....#.#...#....#.
..##.#.#....#...#.....##.......
.#....#..#...#...##..##........
###......#.##....#.#..##.......
...#.....##.#.........#..#.....
.......#.#....#.....##......#..
#..#..............##.#........#
....#.#....#..#.#...##.........
..........#..........#.........
.#.....#.....#.##....#.##..#..#
.......#.......#.#.#.##....#...
..#...........#....#.......##..
..#.#.#.#...##..#.#.#..#...#.#.
..#..#..........#...##....#....
....##.#....#.............#....
.##...##..........#.#..#...#...
#..#..#.##..........##.........
............#.......#..#.....##
....#......#........#..#.##....
#.#......#.#...#.....#.........
..#.....#..#..........#.....#..
.#..#.#.#.##...#..#.#.........#
#...##....#..##..#...#.#.##....
#..##.##.#.##.......#.......#..
#.#.......#........#.##....#.#.
....#..##....##..##......#..##.
#.....#....#.#........####.....
......#...#...###..#...........
.##.#.##...##................##
..##.#.....#.#..#......#.#.....
......#...#........#.....#.##..
#..#.#..#.....#.#..#..##..#.#..
...#.........#.#.#.##...#......
...#..##....#..#.#....#.###.#..
........###................##.#
##...........#......##.##.....#
.#.#.#....#....#....#..........
#.....#........................
....#.....#...#......#.........
....#.#..#..............#......
##.........#..#....#.......#...
.###....#..#.#.####.........#..
..#.#....#.....###..#..........
..........#................#.##"#;